
\subsection{Chassi}

Chassienheten är den enhet som styr över de andra enheterna och bestämmer när de andra enheterna ska utföra sina uppgifter. Chassit är också den enhet som styr motorerna till hjulen. Motorerna är kopplade så att både fram och bakhjul på vardera sida får samma styrsignal, så styrningen blir liknande den på en bandvagn. Motorerna styrs genom en PWM-signal som skickas från chassienhetens processor, se bilaga \ref{sec:tekdok}. Till chassienheten finns även en omkopplare där man kan välja mellan att roboten ska följa linjen autonomt eller om den bara ska gå att styra via persondatorn. Det finns även en tryckknapp som används för att påbörja linjeföljningsproceduren.

\nyBild{chassi_huvudprogram.pdf}{Översiktlig bild av Chassits huvudprogram}{huvudprogram}{0.7}

Chassits huvudprogram startas genom ett knapptryck eller via ett kommando från persondatorn. Då säger chassit till sensorenheten att börja söka efter en linje att följa. Ifall omkopplaren står på manuellt läge händer ingenting mer. Annars ber chassit sensprenheten med jämna mellanrum om en tyngdpunkt samt information om ifall roboten har en station till höger eller vänster. Detta görs fram tills dess att sensoreneheten skickar att roboten är på station. Med hjälp av tyngdpunkten och PD-reglering beräknar chassit vilken hastighet hjulen på vardera sida ska ha för att det ska bli en mjuk lineföljning, se bilaga \ref{sec:tekdok}. 

När sensorenheten skickar att den har upptäckt en station stannar roboten. Sedan säger chassit till sensorenheten att läsa in RFID-taggen som förhoppningsvis ligger under roboten. Sensorenheten skickar tillbaka vilket värde RFID-taggen har. Ifall ingen tagg hittas kör roboten lite framåt och ber sensorenheten att göra en ny läsning. Hittas ingen tagg efter att roboten kört både framåt och bakåt en bit ger roboten upp och kör vidare till nästa station. Om det däremot hittas en tagg tar chassienheten beslut om vad som ska göras beroende på vilket ID taggen har. Beslutet beror på ifall det är en upplockningsstation eller avlämningsstation samt ifall roboten redan bär på något eller ifall stationen redan är avklarad. 

Om roboten har stannat på en station där ett föremål ska plockas upp skickar chassit ett kommando till armen som talar om att ett objekt ska plockas upp och på vilken sida av roboten föremålet befinner sig. När armen sedan utfört sin uppgift enligt kommandot från chassit skickar armen tillbaka att den är klar och om den klarade av att plocka upp eller lägga ner objektet. 

Roboten håller reda på huruvida alla stationer är avklarade genom att räkna hur många stationer den passerar innan den når samma station igen. När alla stationer är avklarade står roboten kvar på sista stationen och texten “Mission Complete” skrivs ut på LCD-displayen. Annars kör roboten vidare till nästa station. Vid varje beslutspunkt i chassits huvudprogram skickar chassit sitt beslut till kommunikationsenheten som i sin tur vidarebefodrar detta till den fjärranslutna datorn. De olika beslutspunkterna är som följer: stanna vid plockstation, RFID inläst, skickar kommando till arm samt arm är klar. 
